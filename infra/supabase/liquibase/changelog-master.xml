<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
    xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
      http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.25.xsd">

  <changeSet id="0001_init.sql" author="timeline" runInTransaction="true">
    <preConditions onFail="MARK_RAN" onError="HALT">
      <or>
        <not>
          <tableExists schemaName="public" tableName="schema_migrations"/>
        </not>
        <sqlCheck expectedResult="0">
          select count(*) from public.schema_migrations where filename = '0001_init.sql'
        </sqlCheck>
      </or>
    </preConditions>
    <sqlFile path="../migrations/0001_init.sql" relativeToChangelogFile="true" splitStatements="false" stripComments="false" endDelimiter=";"/>
  </changeSet>

  <changeSet id="0002_add_task_priority.sql" author="timeline" runInTransaction="true">
    <preConditions onFail="MARK_RAN" onError="HALT">
      <or>
        <not>
          <tableExists schemaName="public" tableName="schema_migrations"/>
        </not>
        <sqlCheck expectedResult="0">
          select count(*) from public.schema_migrations where filename = '0002_add_task_priority.sql'
        </sqlCheck>
      </or>
    </preConditions>
    <sqlFile path="../migrations/0002_add_task_priority.sql" relativeToChangelogFile="true" splitStatements="false" stripComments="false" endDelimiter=";"/>
  </changeSet>

  <changeSet id="0003_add_milestones.sql" author="timeline" runInTransaction="true">
    <preConditions onFail="MARK_RAN" onError="HALT">
      <or>
        <not>
          <tableExists schemaName="public" tableName="schema_migrations"/>
        </not>
        <sqlCheck expectedResult="0">
          select count(*) from public.schema_migrations where filename = '0003_add_milestones.sql'
        </sqlCheck>
      </or>
    </preConditions>
    <sqlFile path="../migrations/0003_add_milestones.sql" relativeToChangelogFile="true" splitStatements="false" stripComments="false" endDelimiter=";"/>
  </changeSet>

  <changeSet id="0004_add_task_repeats.sql" author="timeline" runInTransaction="true">
    <preConditions onFail="MARK_RAN" onError="HALT">
      <or>
        <not>
          <tableExists schemaName="public" tableName="schema_migrations"/>
        </not>
        <sqlCheck expectedResult="0">
          select count(*) from public.schema_migrations where filename = '0004_add_task_repeats.sql'
        </sqlCheck>
      </or>
    </preConditions>
    <sqlFile path="../migrations/0004_add_task_repeats.sql" relativeToChangelogFile="true" splitStatements="false" stripComments="false" endDelimiter=";"/>
  </changeSet>

  <changeSet id="0005_add_cancelled_status.sql" author="timeline" runInTransaction="true">
    <preConditions onFail="MARK_RAN" onError="HALT">
      <or>
        <not>
          <tableExists schemaName="public" tableName="schema_migrations"/>
        </not>
        <sqlCheck expectedResult="0">
          select count(*) from public.schema_migrations where filename = '0005_add_cancelled_status.sql'
        </sqlCheck>
      </or>
    </preConditions>
    <sqlFile path="../migrations/0005_add_cancelled_status.sql" relativeToChangelogFile="true" splitStatements="false" stripComments="false" endDelimiter=";"/>
  </changeSet>

  <changeSet id="0006_add_task_assignees.sql" author="timeline" runInTransaction="true">
    <preConditions onFail="MARK_RAN" onError="HALT">
      <or>
        <not>
          <tableExists schemaName="public" tableName="schema_migrations"/>
        </not>
        <sqlCheck expectedResult="0">
          select count(*) from public.schema_migrations where filename = '0006_add_task_assignees.sql'
        </sqlCheck>
      </or>
    </preConditions>
    <sqlFile path="../migrations/0006_add_task_assignees.sql" relativeToChangelogFile="true" splitStatements="false" stripComments="false" endDelimiter=";"/>
  </changeSet>

  <changeSet id="0007_add_super_admins.sql" author="timeline" runInTransaction="true">
    <preConditions onFail="MARK_RAN" onError="HALT">
      <or>
        <not>
          <tableExists schemaName="public" tableName="schema_migrations"/>
        </not>
        <sqlCheck expectedResult="0">
          select count(*) from public.schema_migrations where filename = '0007_add_super_admins.sql'
        </sqlCheck>
      </or>
    </preConditions>
    <sqlFile path="../migrations/0007_add_super_admins.sql" relativeToChangelogFile="true" splitStatements="false" stripComments="false" endDelimiter=";"/>
  </changeSet>

  <changeSet id="0008_profile_email_guard.sql" author="timeline" runInTransaction="true">
    <preConditions onFail="MARK_RAN" onError="HALT">
      <or>
        <not>
          <tableExists schemaName="public" tableName="schema_migrations"/>
        </not>
        <sqlCheck expectedResult="0">
          select count(*) from public.schema_migrations where filename = '0008_profile_email_guard.sql'
        </sqlCheck>
      </or>
    </preConditions>
    <sqlFile path="../migrations/0008_profile_email_guard.sql" relativeToChangelogFile="true" splitStatements="false" stripComments="false" endDelimiter=";"/>
  </changeSet>

  <changeSet id="0009_add_workspace_indexes.sql" author="timeline" runInTransaction="true">
    <preConditions onFail="MARK_RAN" onError="HALT">
      <or>
        <not>
          <tableExists schemaName="public" tableName="schema_migrations"/>
        </not>
        <sqlCheck expectedResult="0">
          select count(*) from public.schema_migrations where filename = '0009_add_workspace_indexes.sql'
        </sqlCheck>
      </or>
    </preConditions>
    <sqlFile path="../migrations/0009_add_workspace_indexes.sql" relativeToChangelogFile="true" splitStatements="false" stripComments="false" endDelimiter=";"/>
  </changeSet>

  <changeSet id="0010_add_dashboard.sql" author="timeline" runInTransaction="true">
    <preConditions onFail="MARK_RAN" onError="HALT">
      <or>
        <not>
          <tableExists schemaName="public" tableName="schema_migrations"/>
        </not>
        <sqlCheck expectedResult="0">
          select count(*) from public.schema_migrations where filename = '0010_add_dashboard.sql'
        </sqlCheck>
      </or>
    </preConditions>
    <sqlFile path="../migrations/0010_add_dashboard.sql" relativeToChangelogFile="true" splitStatements="false" stripComments="false" endDelimiter=";"/>
  </changeSet>

  <changeSet id="0011_add_dashboard_time_series.sql" author="timeline" runInTransaction="true">
    <preConditions onFail="MARK_RAN" onError="HALT">
      <or>
        <not>
          <tableExists schemaName="public" tableName="schema_migrations"/>
        </not>
        <sqlCheck expectedResult="0">
          select count(*) from public.schema_migrations where filename = '0011_add_dashboard_time_series.sql'
        </sqlCheck>
      </or>
    </preConditions>
    <sqlFile path="../migrations/0011_add_dashboard_time_series.sql" relativeToChangelogFile="true" splitStatements="false" stripComments="false" endDelimiter=";"/>
  </changeSet>

  <changeSet id="0012_add_project_archive_and_assignee_active.sql" author="timeline" runInTransaction="true">
    <preConditions onFail="MARK_RAN" onError="HALT">
      <or>
        <not>
          <tableExists schemaName="public" tableName="schema_migrations"/>
        </not>
        <sqlCheck expectedResult="0">
          select count(*) from public.schema_migrations where filename = '0012_add_project_archive_and_assignee_active.sql'
        </sqlCheck>
      </or>
    </preConditions>
    <sqlFile path="../migrations/0012_add_project_archive_and_assignee_active.sql" relativeToChangelogFile="true" splitStatements="false" stripComments="false" endDelimiter=";"/>
  </changeSet>

  <changeSet id="0013_add_dashboard_base_counts.sql" author="timeline" runInTransaction="true">
    <preConditions onFail="MARK_RAN" onError="HALT">
      <or>
        <not>
          <tableExists schemaName="public" tableName="schema_migrations"/>
        </not>
        <sqlCheck expectedResult="0">
          select count(*) from public.schema_migrations where filename = '0013_add_dashboard_base_counts.sql'
        </sqlCheck>
      </or>
    </preConditions>
    <sqlFile path="../migrations/0013_add_dashboard_base_counts.sql" relativeToChangelogFile="true" splitStatements="false" stripComments="false" endDelimiter=";"/>
  </changeSet>

  <changeSet id="0014_remove_review_status.sql" author="timeline" runInTransaction="true">
    <preConditions onFail="MARK_RAN" onError="HALT">
      <or>
        <not>
          <tableExists schemaName="public" tableName="schema_migrations"/>
        </not>
        <sqlCheck expectedResult="0">
          select count(*) from public.schema_migrations where filename = '0014_remove_review_status.sql'
        </sqlCheck>
      </or>
    </preConditions>
    <sqlFile path="../migrations/0014_remove_review_status.sql" relativeToChangelogFile="true" splitStatements="false" stripComments="false" endDelimiter=";"/>
  </changeSet>

  <changeSet id="0015_add_status_emojis.sql" author="timeline" runInTransaction="true">
    <preConditions onFail="MARK_RAN" onError="HALT">
      <or>
        <not>
          <tableExists schemaName="public" tableName="schema_migrations"/>
        </not>
        <sqlCheck expectedResult="0">
          select count(*) from public.schema_migrations where filename = '0015_add_status_emojis.sql'
        </sqlCheck>
      </or>
    </preConditions>
    <sqlFile path="../migrations/0015_add_status_emojis.sql" relativeToChangelogFile="true" splitStatements="false" stripComments="false" endDelimiter=";"/>
  </changeSet>

  <changeSet id="0016_add_status_emoji_column.sql" author="timeline" runInTransaction="true">
    <preConditions onFail="MARK_RAN" onError="HALT">
      <or>
        <not>
          <tableExists schemaName="public" tableName="schema_migrations"/>
        </not>
        <sqlCheck expectedResult="0">
          select count(*) from public.schema_migrations where filename = '0016_add_status_emoji_column.sql'
        </sqlCheck>
      </or>
    </preConditions>
    <sqlFile path="../migrations/0016_add_status_emoji_column.sql" relativeToChangelogFile="true" splitStatements="false" stripComments="false" endDelimiter=";"/>
  </changeSet>

  <changeSet id="0017_dedupe_statuses_case_insensitive.sql" author="timeline" runInTransaction="true">
    <preConditions onFail="MARK_RAN" onError="HALT">
      <or>
        <not>
          <tableExists schemaName="public" tableName="schema_migrations"/>
        </not>
        <sqlCheck expectedResult="0">
          select count(*) from public.schema_migrations where filename = '0017_dedupe_statuses_case_insensitive.sql'
        </sqlCheck>
      </or>
    </preConditions>
    <sqlFile path="../migrations/0017_dedupe_statuses_case_insensitive.sql" relativeToChangelogFile="true" splitStatements="false" stripComments="false" endDelimiter=";"/>
  </changeSet>

  <changeSet id="0018_add_status_cancelled_flag.sql" author="timeline" runInTransaction="true">
    <preConditions onFail="MARK_RAN" onError="HALT">
      <or>
        <not>
          <tableExists schemaName="public" tableName="schema_migrations"/>
        </not>
        <sqlCheck expectedResult="0">
          select count(*) from public.schema_migrations where filename = '0018_add_status_cancelled_flag.sql'
        </sqlCheck>
      </or>
    </preConditions>
    <sqlFile path="../migrations/0018_add_status_cancelled_flag.sql" relativeToChangelogFile="true" splitStatements="false" stripComments="false" endDelimiter=";"/>
  </changeSet>

  <changeSet id="0019_normalize_status_names.sql" author="timeline" runInTransaction="true">
    <preConditions onFail="MARK_RAN" onError="HALT">
      <or>
        <not>
          <tableExists schemaName="public" tableName="schema_migrations"/>
        </not>
        <sqlCheck expectedResult="0">
          select count(*) from public.schema_migrations where filename = '0019_normalize_status_names.sql'
        </sqlCheck>
      </or>
    </preConditions>
    <sqlFile path="../migrations/0019_normalize_status_names.sql" relativeToChangelogFile="true" splitStatements="false" stripComments="false" endDelimiter=";"/>
  </changeSet>

  <changeSet id="0020_add_customers.sql" author="timeline" runInTransaction="true">
    <preConditions onFail="MARK_RAN" onError="HALT">
      <or>
        <not>
          <tableExists schemaName="public" tableName="schema_migrations"/>
        </not>
        <sqlCheck expectedResult="0">
          select count(*) from public.schema_migrations where filename = '0020_add_customers.sql'
        </sqlCheck>
      </or>
    </preConditions>
    <sqlFile path="../migrations/0020_add_customers.sql" relativeToChangelogFile="true" splitStatements="false" stripComments="false" endDelimiter=";"/>
  </changeSet>

  <changeSet id="0021_add_project_code.sql" author="timeline" runInTransaction="true">
    <preConditions onFail="MARK_RAN" onError="HALT">
      <or>
        <not>
          <tableExists schemaName="public" tableName="schema_migrations"/>
        </not>
        <sqlCheck expectedResult="0">
          select count(*) from public.schema_migrations where filename = '0021_add_project_code.sql'
        </sqlCheck>
      </or>
    </preConditions>
    <sqlFile path="../migrations/0021_add_project_code.sql" relativeToChangelogFile="true" splitStatements="false" stripComments="false" endDelimiter=";"/>
  </changeSet>

  <changeSet id="0022_add_multi_dashboards.sql" author="timeline" runInTransaction="true">
    <preConditions onFail="MARK_RAN" onError="HALT">
      <or>
        <not>
          <tableExists schemaName="public" tableName="schema_migrations"/>
        </not>
        <sqlCheck expectedResult="0">
          select count(*) from public.schema_migrations where filename = '0022_add_multi_dashboards.sql'
        </sqlCheck>
      </or>
    </preConditions>
    <sqlFile path="../migrations/0022_add_multi_dashboards.sql" relativeToChangelogFile="true" splitStatements="false" stripComments="false" endDelimiter=";"/>
  </changeSet>

  <changeSet id="0023_add_member_groups.sql" author="timeline" runInTransaction="true">
    <preConditions onFail="MARK_RAN" onError="HALT">
      <or>
        <not>
          <tableExists schemaName="public" tableName="schema_migrations"/>
        </not>
        <sqlCheck expectedResult="0">
          select count(*) from public.schema_migrations where filename = '0023_add_member_groups.sql'
        </sqlCheck>
      </or>
    </preConditions>
    <sqlFile path="../migrations/0023_add_member_groups.sql" relativeToChangelogFile="true" splitStatements="false" stripComments="false" endDelimiter=";"/>
  </changeSet>

  <changeSet id="0024_add_project_tracking.sql" author="timeline" runInTransaction="true">
    <preConditions onFail="MARK_RAN" onError="HALT">
      <or>
        <not>
          <tableExists schemaName="public" tableName="schema_migrations"/>
        </not>
        <sqlCheck expectedResult="0">
          select count(*) from public.schema_migrations where filename = '0024_add_project_tracking.sql'
        </sqlCheck>
      </or>
    </preConditions>
    <sqlFile path="../migrations/0024_add_project_tracking.sql" relativeToChangelogFile="true" splitStatements="false" stripComments="false" endDelimiter=";"/>
  </changeSet>

  <changeSet id="0025_add_profile_locale.sql" author="timeline" runInTransaction="true">
    <preConditions onFail="MARK_RAN" onError="HALT">
      <or>
        <not>
          <tableExists schemaName="public" tableName="schema_migrations"/>
        </not>
        <sqlCheck expectedResult="0">
          select count(*) from public.schema_migrations where filename = '0025_add_profile_locale.sql'
        </sqlCheck>
      </or>
    </preConditions>
    <sqlFile path="../migrations/0025_add_profile_locale.sql" relativeToChangelogFile="true" splitStatements="false" stripComments="false" endDelimiter=";"/>
  </changeSet>

  <changeSet id="0026_keycloak_identity_helpers.sql" author="timeline" runInTransaction="true">
    <preConditions onFail="MARK_RAN" onError="HALT">
      <or>
        <not>
          <tableExists schemaName="public" tableName="schema_migrations"/>
        </not>
        <sqlCheck expectedResult="0">
          select count(*) from public.schema_migrations where filename = '0026_keycloak_identity_helpers.sql'
        </sqlCheck>
      </or>
    </preConditions>
    <sqlFile path="../migrations/0026_keycloak_identity_helpers.sql" relativeToChangelogFile="true" splitStatements="false" stripComments="false" endDelimiter=";"/>
  </changeSet>

  <changeSet id="0027_drop_legacy_migration_runner_tables.sql" author="timeline" runInTransaction="true">
    <sqlFile path="../migrations/0027_drop_legacy_migration_runner_tables.sql" relativeToChangelogFile="true" splitStatements="true" stripComments="false" endDelimiter=";"/>
  </changeSet>

  <changeSet id="0028_add_task_media.sql" author="timeline" runInTransaction="true">
    <preConditions onFail="MARK_RAN" onError="HALT">
      <or>
        <not>
          <tableExists schemaName="public" tableName="schema_migrations"/>
        </not>
        <sqlCheck expectedResult="0">
          select count(*) from public.schema_migrations where filename = '0028_add_task_media.sql'
        </sqlCheck>
      </or>
    </preConditions>
    <sqlFile path="../migrations/0028_add_task_media.sql" relativeToChangelogFile="true" splitStatements="false" stripComments="false" endDelimiter=";"/>
  </changeSet>

  <changeSet id="0029_task_media_token_ttl_revocation.sql" author="timeline" runInTransaction="true">
    <preConditions onFail="MARK_RAN" onError="HALT">
      <or>
        <not>
          <tableExists schemaName="public" tableName="schema_migrations"/>
        </not>
        <sqlCheck expectedResult="0">
          select count(*) from public.schema_migrations where filename = '0029_task_media_token_ttl_revocation.sql'
        </sqlCheck>
      </or>
    </preConditions>
    <sqlFile path="../migrations/0029_task_media_token_ttl_revocation.sql" relativeToChangelogFile="true" splitStatements="false" stripComments="false" endDelimiter=";"/>
  </changeSet>

  <changeSet id="0030_ensure_initial_workspace.sql" author="timeline" runInTransaction="true">
    <preConditions onFail="MARK_RAN" onError="HALT">
      <or>
        <not>
          <tableExists schemaName="public" tableName="schema_migrations"/>
        </not>
        <sqlCheck expectedResult="0">
          select count(*) from public.schema_migrations where filename = '0030_ensure_initial_workspace.sql'
        </sqlCheck>
      </or>
    </preConditions>
    <sqlFile path="../migrations/0030_ensure_initial_workspace.sql" relativeToChangelogFile="true" splitStatements="false" stripComments="false" endDelimiter=";"/>
  </changeSet>

  <changeSet id="0031_pending_workspace_invites.sql" author="timeline" runInTransaction="true">
    <preConditions onFail="MARK_RAN" onError="HALT">
      <or>
        <not>
          <tableExists schemaName="public" tableName="schema_migrations"/>
        </not>
        <sqlCheck expectedResult="0">
          select count(*) from public.schema_migrations where filename = '0031_pending_workspace_invites.sql'
        </sqlCheck>
      </or>
    </preConditions>
    <sqlFile path="../migrations/0031_pending_workspace_invites.sql" relativeToChangelogFile="true" splitStatements="false" stripComments="false" endDelimiter=";"/>
  </changeSet>

  <changeSet id="0032_workspace_invite_revocation_reason.sql" author="timeline" runInTransaction="true">
    <preConditions onFail="MARK_RAN" onError="HALT">
      <or>
        <not>
          <tableExists schemaName="public" tableName="schema_migrations"/>
        </not>
        <sqlCheck expectedResult="0">
          select count(*) from public.schema_migrations where filename = '0032_workspace_invite_revocation_reason.sql'
        </sqlCheck>
      </or>
    </preConditions>
    <sqlFile path="../migrations/0032_workspace_invite_revocation_reason.sql" relativeToChangelogFile="true" splitStatements="false" stripComments="false" endDelimiter=";"/>
  </changeSet>

  <changeSet id="0033_workspace_holiday_country.sql" author="timeline" runInTransaction="true">
    <preConditions onFail="MARK_RAN" onError="HALT">
      <or>
        <not>
          <tableExists schemaName="public" tableName="schema_migrations"/>
        </not>
        <sqlCheck expectedResult="0">
          select count(*) from public.schema_migrations where filename = '0033_workspace_holiday_country.sql'
        </sqlCheck>
      </or>
    </preConditions>
    <sqlFile path="../migrations/0033_workspace_holiday_country.sql" relativeToChangelogFile="true" splitStatements="false" stripComments="false" endDelimiter=";"/>
  </changeSet>

  <changeSet id="0034_workspace_owner_member_removal.sql" author="timeline" runInTransaction="true">
    <preConditions onFail="MARK_RAN" onError="HALT">
      <or>
        <not>
          <tableExists schemaName="public" tableName="schema_migrations"/>
        </not>
        <sqlCheck expectedResult="0">
          select count(*) from public.schema_migrations where filename = '0034_workspace_owner_member_removal.sql'
        </sqlCheck>
      </or>
    </preConditions>
    <sqlFile path="../migrations/0034_workspace_owner_member_removal.sql" relativeToChangelogFile="true" splitStatements="false" stripComments="false" endDelimiter=";"/>
  </changeSet>

  <changeSet id="0035_prevent_assigning_disabled_members.sql" author="timeline" runInTransaction="true">
    <preConditions onFail="MARK_RAN" onError="HALT">
      <or>
        <not>
          <tableExists schemaName="public" tableName="schema_migrations"/>
        </not>
        <sqlCheck expectedResult="0">
          select count(*) from public.schema_migrations where filename = '0035_prevent_assigning_disabled_members.sql'
        </sqlCheck>
      </or>
    </preConditions>
    <sqlFile path="../migrations/0035_prevent_assigning_disabled_members.sql" relativeToChangelogFile="true" splitStatements="false" stripComments="false" endDelimiter=";"/>
  </changeSet>

  <changeSet id="0036_assignee_unique_task_counts.sql" author="timeline" runInTransaction="true">
    <preConditions onFail="MARK_RAN" onError="HALT">
      <or>
        <not>
          <tableExists schemaName="public" tableName="schema_migrations"/>
        </not>
        <sqlCheck expectedResult="0">
          select count(*) from public.schema_migrations where filename = '0036_assignee_unique_task_counts.sql'
        </sqlCheck>
      </or>
    </preConditions>
    <sqlFile path="../migrations/0036_assignee_unique_task_counts.sql" relativeToChangelogFile="true" splitStatements="false" stripComments="false" endDelimiter=";"/>
  </changeSet>

</databaseChangeLog>
